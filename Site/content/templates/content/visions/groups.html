{% extends "content/base.html" %}
{% load static %}

{% block content %}
<div class="container">
 <div class="section">
  <div class="row z-depth-3">
   <div class="col s12">
    <h2 class="center">Groups and Teams</h2>
   </div><!-- .col -->
  </div><!-- .row -->
 </div><!-- .section -->
</div><!-- .container -->

<div class="container">
 <div class="section">
  <div class="row">
  {% for vis_dict in visions_list_obj.visions_list_data %}
   {% if vis_dict.col_classes %}
   <div class="col hoverable {{ vis_dict.col_classes }}">
   {% else %}
   <div class="col hoverable s12 m6 l6">
   {% endif %}
   {% if vis_dict.vision_type == 'groups' %}
    <div class="groups-card z-depth-3">
     <h2 class="header center">{{ vis_dict.title }}</h2>
     <div class="z-depth-3 groups-images">
      <div class="card horizontal">
       {% for image_data_dict in vis_dict.image_data %}
        <div class="card-image group-image">
         <a href="/visions/story/{{ vis_dict.vision_file_no_ext }}"
            title="Go to the story about {{ vis_dict.title }}">
          <h5 class="grey-text text-darken-4 center">{{ image_data_dict.name }}</h5>
          <img src="{% static image_data_dict.image_file_path %}"></a>
        </div>
       {% endfor %}
      </div><!-- .card .horizontal -->
      <div class="card">
       <div class="card-content">
        <a class="center" id="toggle-fp-{{ vis_dict.group_slug }}"
           title="Show the first-person backstory">
         <span class="card-title activator grey-text text-darken-4">
          {% if vis_dict.subtitle_html %}
           {% autoescape off %}
            {{ vis_dict.subtitle_html|safe }}
           {% endautoescape %}
          {% endif %}
          {% if vis_dict.card_first_person_html and vis_dict.group_slug %}
           &nbsp;
           <i class="fa fa-lg fa-comment yellow-text text-darken-3"
              aria-hidden="true"></i>
          {% endif %}
         </span>
        </a>
        {% if vis_dict.card_first_person_html and vis_dict.group_slug %}
         <div id="fp-backstory-{{ vis_dict.group_slug }}"
              class="avs-text-to-toggle">
          <p class="left-align">
           {{ vis_dict.card_first_person_html|safe }}
           <span class="right">
             &nbsp;&ndash;&nbsp;{{ vis_dict.author }}, {{ vis_dict.date }}.
           </span>
           <br>
          </p>
          <hr>
         </div><!-- .fp-backstory-* -->
        {% endif %}
        {{ vis_dict.card_content_html|safe }}
       </div><!-- .card-content -->
      </div><!-- .card -->
     </div><!-- .z-depth-3 -->
    </div><!-- .groups-card  .z-depth-3 -->
   {% else %}
    <div class="card z-depth-3">
     <div class="card-content">
      {{ vis_dict.card_content_html|safe }}
      </div>
     </div><!-- .card-content -->
    </div><!-- .card -->
   {% endif %}
   </div><!-- .col -->
  {% endfor %}
  </div><!-- .row -->
 </div><!-- .section -->
</div><!-- .container -->
{% endblock %}

{% block scripts %}
 {{ block.super }}
 <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js">
 </script>
 <script>
  {% for vis_dict in visions_list_obj.visions_list_data %}
   {% if vis_dict.card_first_person_html and vis_dict.group_slug %}
    console.log('vis_dict.group_slug: {{ vis_dict.group_slug }}');
    $("#toggle-fp-{{ vis_dict.group_slug }}").click(function() {
     $("#fp-backstory-{{ vis_dict.group_slug }}").toggle("blind", "slow");
    });
   {% endif %}
  {% endfor %}
 </script>
{% endblock %}
